spring:
  application:
    name: channel-gateway

  profiles:
    active: local

  cloud:
    config:
      fail-fast: true
      allow-override: true
      username: user
      password: user

    gateway:
      httpserver:
        wiretap: false # debugging = true
      httpclient:
        connect-timeout: 3_000
        response-timeout: 5s
        pool:
          type: elastic
          max-idle-time: 60s
          acquire-timeout: 45_000
        compression: true
        ssl:
          handshake-timeout: 10s
          close-notify-flush-timeout: 3s
          close-notify-read-timeout: 10s
        wiretap: false # debugging = true

      globalcors:
        corsConfigurations:
          '[/**]':
            allowedOriginPatterns: '*'
            allowCredentials: true
            allowedHeaders: '*'
            allowedMethods:
              - GET
              - POST
              - HEAD
              - OPTIONS

      default-filters:
#        - RemoveHttpHeadersFilter
#        - HeaderFilter

    security:
      user:
        name: user
        password: user_dev

    endpoint:
      health:
        enabled: true
        show-details: never
      refresh:
        enabled: true
    tracing:
      enabled: true
      sampling:
        probability: 1.0
      propagation:
        type: w3c

logging:
  config: classpath:logback-spring.xml
  level:
    org.springframework.cloud.gateway: INFO
    org.springframework.http.server.reactive: INFO
    org.springframework.web.reactive: INFO
    org.springframework.boot.autoconfigure.web: INFO
    reactor.netty: INFO

management:
  tracing:
    baggage:
      correlation:
        fields:
          - uri
          - svc_nation_cd
          - appNo
          - contexturl
          - useragent
          - postion
          - location
          - targetserver
          - detailmessage
          - page_no
          - device_info
          - clientIP

# 커스텀 HTTP 포트 설정 추가
custom:
  http:
    port: 8888
    enabled: true

# server graceful 추가
server:
  shutdown: graceful
  port: 8443
  ssl:
    enabled: true
    key-store: classpath:certs/gateway.p12
    key-store-password: changeit
    key-store-type: PKCS12
    key-alias: 1
    protocol: TLS
    enabled-protocols: TLSv1.2,TLSv1.3
#    ciphers:
#      - TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
#      - TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256

